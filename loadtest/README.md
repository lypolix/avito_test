# Load testing 

Нагрузочное тестирование. Я реализовала воспроизводимый HTTP‑нагрузочный раннер на Go для сервиса. Раннер генерирует трафик по профилям (smoke, baseline, mass), измеряет задержки каждого запроса и пишет JSON‑отчёты с метриками.

## Как это работает

- Concurrency: поднимается N горутин‑воркеров, каждый со своим RNGгенератором случайных чисел.
- Интенсивность: общий `time.Ticker` реализует целевой суммарный RPS.
- HTTP клиент: общий `http.Client`.
- Сценарии: бизнес‑последовательности запросов, приближённые к реальным.
- Прогрев: начальный прогрев исключён из метрик, чтобы не портить p95/p99 холодным кэшем/пулами.
- Пер‑путевая статистика: собираются счётчики кодов 2xx/4xx/5xx; успешность для SLI считается по 5xx/сетевым.

## Профили нагрузки

- smoke
  - Цель: проверка доступности и базовых операций.
  - Шаги: GET /health, POST /pullRequest/create (1 пользователь).
  - Порог: 0 5xx, p95 < 300 мс.
- baseline
  - Цель: типичный пользовательский сценарий при умеренном RPS.
  - Шаги: create (40%), getReview (30%), reassign (20%), merge (10%). (Хранит пул ID созданных PR и удаляет из пула после успешного merge. Это снижает 404/409)
- mass
  - Цель: операционные действия и их влияние на чтения.
  - Шаги: предварительно создаёт набор PR, часто делает getReview.

## Сигнатуры команд

С Makefile:
- `make load-test-smoke` / `make load-test-baseline` / `make load-test-mass`
- `make load-test-all` — последовательно прогоняет три профиля
- `make load-run-all` — поднимает изолированный load‑стек и прогоняет все профили

## Что означают метрики

- `requests` — число запросов, попавших в окно метрик.
- `errors` — число отказов по SLI.
- `p50_ms` — медиана задержки: типичный запрос.
- `p95_ms` — 95% ниже этого значения.
- `p99_ms` — 99% ниже этого значения.
- `avg_ms` — среднее.
- `max_ms/min_ms` — экстремумы.
- `by_path` - отделение доменных 4xx от отказов сервера.

## Интерпретация результатов

SLO:
- Объём данных: до 20 команд и 200 пользователей.
- RPS: 5.
- SLI времени ответа: ≤ 300 мс.
- SLI успешности: 99.9%.

Примеры (реальные артефакты):

Можно посмотреть по /loatest/results/ (Все прогоны пишутся в `loadtest/results/*.json`)
